# Webhook API Endpoints

# GET /webhooks/{platform}
/webhooks/{platform}:
  get:
    tags:
      - Webhooks
    summary: Verify webhook
    description: Verify webhook for a specific platform
    parameters:
      - name: platform
        in: path
        description: Platform name (e.g., zalo)
        required: true
        schema:
          type: string
          enum: [zalo]
      - name: access_token
        in: query
        description: Access token for verification
        schema:
          type: string
      - name: challenge_code
        in: query
        description: Challenge code for verification
        schema:
          type: string
    responses:
      200:
        description: Webhook verified
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        verified:
                          type: boolean
      400:
        $ref: '#/components/responses/BadRequest'
      401:
        $ref: '#/components/responses/Unauthorized'
      500:
        $ref: '#/components/responses/InternalServerError'

# POST /webhooks/{platform}
  post:
    tags:
      - Webhooks
    summary: Receive webhook event
    description: Receive and process webhook event from a specific platform
    parameters:
      - name: platform
        in: path
        description: Platform name (e.g., zalo)
        required: true
        schema:
          type: string
          enum: [zalo]
    requestBody:
      description: Webhook event data
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              app_id:
                type: string
              user_id_by_app:
                type: string
              event_name:
                type: string
              timestamp:
                type: string
              sender:
                type: object
                properties:
                  id:
                    type: string
              recipient:
                type: object
                properties:
                  id:
                    type: string
              message:
                type: object
                properties:
                  msg_id:
                    type: string
                  text:
                    type: string
    responses:
      200:
        description: Event received
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        received:
                          type: boolean
      400:
        $ref: '#/components/responses/BadRequest'
      500:
        $ref: '#/components/responses/InternalServerError'
